# 18장. 최적의 아키텍처 스타일 선정

## 18.1 아키텍처 유행은 계속 변한다.

1. **과거의 경험**
    - 아키텍트는 과거의 경험을 바탕으로 아키텍처 설계를 합니다. 과거에 겪었던 결함이나 단점은 새로운 설계에 반영되며, 이전 시스템에서의 문제를 해결하려는 노력이 현재의 아키텍처를 형성하게 된다.
2. **생태계의 변화**
    - 소프트웨어 개발 생태계는 끊임없이 변화하고 있으며, 예측하기 어려운 변화가 일어난다. 예를 들어, 과거에는 쿠버네티스 같은 기술이 거의 알려지지 않았지만 지금은 대세가 되어 가고 있다. 이러한 변화는 예상치 못한 도구와 기술로 아키텍처에 영향을 미칠 수 있다.
3. **새로운 기능과 패러다임 전환**
    - 새로운 기능의 출현은 아키텍처에 큰 변화를 일으킬 수 있다. 예를 들어, 도커와 같은 컨테이너 기술이 등장하면서 소프트웨어 개발에 혁신을 가져왔다. 새로운 도구와 기능들은 기존 시스템을 완전히 대체하기보다는 점진적으로 아키텍처의 패러다임을 변화시킨다.
4. **변화의 속도 가속화**
    - 생태계의 변화는 점점 더 빨라지고 있으며, 새로운 도구와 엔지니어링 프랙티스는 빠르게 발전하고 있다. 아키텍트는 이러한 지속적인 변화를 따라가며, 새로운 설계와 기능을 도입하는 데 있어 유연함과 빠른 대응이 중요해졌다.

## 18.2 결정 기준

### 1. **도메인 이해**

- 아키텍트는 시스템 설계 전에 해당 도메인에서 중요한 요소들을 파악해야 한다. 도메인 전문가가 아니더라도 최소한 해당 도메인에 대한 기본적인 이해는 필요하다. 도메인의 특성이 아키텍처 설계에 큰 영향을 미치기 때문에 아키텍트는 그 부분을 충분히 고려해야 한다.

### 2. **구조에 영향을 미치는 아키텍처 특성**

- 아키텍트는 시스템의 요구사항을 충족시키기 위해 도메인 및 외부 요소에 맞는 아키텍처 특성을 정의해야 한다. 데이터 아키텍처, 조직 내 구조적 요소, 외부 팩터 등을 고려하여 설계해야 한다.

### 3. **데이터 아키텍처**

- 데이터베이스 설계는 아키텍트와 DBA의 협업을 필요로 하다. 데이터 아키텍처는 시스템의 성능에 중요한 영향을 미치므로, 새로운 시스템이 기존의 데이터 아키텍처와 어떻게 상호작용할지 충분히 파악해야 한다.

### 4. **조직 문제**

- 조직 내 환경도 아키텍처 설계에 영향을 미친다. 예를 들어, 클라우드 벤더사의 가격이나 인수 합병 등의 외부 요인이 시스템 설계에 영향을 줄 수 있다.

### 5. **프로세스, 팀, 운영 문제에 관한 지식**

- 소프트웨어 개발의 프로세스, 팀 간 소통, QA 프로세스 등의 요소도 아키텍처 설계에 영향을 미친다. 애자일 성숙도가 부족한 조직에서는 애자일 기반의 아키텍처를 도입하는 데 어려움을 겪을 수 있다.

### 6. **도메인/아키텍처 동형성**

- 특정 아키텍처 스타일은 특정 문제 영역과 잘 맞을 수 있다. 예를 들어, 마이크로커널 아키텍처는 플러그인 기반의 커스터마이징이 필요한 시스템과 잘 맞고, 공간 기반 아키텍처는 대규모 연산 작업이 필요한 시스템에 적합합니다. 반면, 모놀리식 아키텍처는 확장성에 어려움이 있을 수 있다.

### 7. **모놀리스 vs 분산 아키텍처**

- 아키텍트는 아키텍처의 특성을 고려해 모놀리식 아키텍처가 적합한지, 아니면 분산 아키텍처가 필요한지를 결정해야 한다. 분산 아키텍처는 각 서비스별로 다른 아키텍처 특성을 필요로 할 수 있으며, 이로 인해 시스템 설계가 더욱 복잡해질 수 있다.

### 8. **데이터 분할**

- 아키텍트는 시스템 내에서 데이터를 어떻게 분할할 것인지, 각 서비스가 어떤 데이터를 저장할 것인지 결정해야 한다. 데이터 흐름을 잘 파악하고, 이를 최적화하는 설계를 해야 한다.

### 9. **서비스 간 통신 방식**

- 서비스 간 통신은 동기와 비동기 중 어느 방식을 선택할지 고민해야 한다. 동기 통신은 간편하지만 확장성에 한계가 있을 수 있고, 비동기 통신은 성능에서 장점이 있지만 구현과 디버깅이 복잡할 수 있다. 대부분의 경우 동기 통신을 기본으로 하고, 필요 시 비동기 통신을 사용하는 것이 좋다.

### 10. **결과물과 아키텍처 기록**

- 설계 과정이 완료되면, 아키텍트는 아키텍처 스타일과 하이브리드화가 반영된 아키텍처 토폴로지를 정의하고, 중요한 설계 원칙과 아키텍처 특성을 지키기 위한 아키텍처 피트니스 함수를 문서화해야 한다.

## **18.3** 모놀리스 사례 연구: 실리콘 샌드위치

### **모놀리스 설계**

- **장점**: 단순성, 빠른 개발과 배포, 관리 용이, 통합성.
- **단점**: 확장성 한계, 높은 커플링, 변화에 대한 유연성 부족.

### **도메인/기술 분할 설계**

- **장점**: 확장성, 독립적인 컴포넌트 관리, 기술 선택의 유연성.
- **단점**: 복잡성 증가, 서비스 간 통신 및 데이터 관리 어려움.

### 18.3.2 마이크로커널

1. **맞춤성**:
    - 실리콘 샌드위치에서 중요한 아키텍처 특성 중 하나는 맞춤성.
    - 아키텍트는 도메인/아키텍처 동형성 검토 후 마이크로커널 아키텍처로 구현할 수 있다.
2. **마이크로커널 아키텍처**:
    - 코어 시스템은 도메인 컴포넌트와 단일 관계형 데이터베이스로 구성된다.
    - 커스터마이징은 플러그인 형태로 제공되며, 플러그인 간 커플링 없이 독립적으로 데이터를 유지한다.
    - 향후 분산 아키텍처로의 마이그레이션 가능성을 염두에 두고 설계된다.
3. **백엔드 포 프런트엔드 (BFF) 패턴**:
    - BFF 패턴을 활용하여 프런트엔드에 적합한 형태로 백엔드 데이터를 변환한다.
    - 예시: iOS용 BFF가 데이터를 iOS 네이티브 애플리케이션의 사양에 맞게 변환한다.
    - 이를 통해 마이크로커널 스타일의 유연한 사용자 인터페이스와 확장 지원을 제공한다.
4. **통신 방식**:
    - 실리콘 샌드위치 아키텍처는 엄청난 성능이나 탄력성을 요구하지 않으며, 오래 걸릴 작업이 없으므로 동기식 통신으로 충분하다.
